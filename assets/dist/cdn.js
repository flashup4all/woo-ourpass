"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _classPrivateFieldInitSpec(a,b,c){_checkPrivateRedeclaration(a,b),b.set(a,c)}function _checkPrivateRedeclaration(a,b){if(b.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(a,b){var c=_classExtractFieldDescriptor(a,b,"get");return _classApplyDescriptorGet(a,c)}function _classApplyDescriptorGet(a,b){return b.get?b.get.call(a):b.value}function _classPrivateFieldSet(a,b,c){var d=_classExtractFieldDescriptor(a,b,"set");return _classApplyDescriptorSet(a,d,c),c}function _classExtractFieldDescriptor(a,b,c){if(!b.has(a))throw new TypeError("attempted to "+c+" private field on non-instance");return b.get(a)}function _classApplyDescriptorSet(a,b,c){if(b.set)b.set.call(a,c);else{if(!b.writable)throw new TypeError("attempted to set read only private field");b.value=c}}var _isMobileDevice=new WeakMap,_dStyle=new WeakMap,_environments=new WeakMap,_config=new WeakMap,Ourpass=function(){function a(){_classCallCheck(this,a),_classPrivateFieldInitSpec(this,_isMobileDevice,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_dStyle,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_environments,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_config,{writable:!0,value:void 0}),_classPrivateFieldSet(this,_isMobileDevice,/Mobi/i.test(window.navigator.userAgent)),_classPrivateFieldSet(this,_dStyle,{ourpassLoaderWrapper:"\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    ",ourpassLoaderImg:"\n      height: 80px;\n      width: 80px;\n      animation: loader 1s 1s infinite;\n      display: block;\n    ",ourpassParentModal:"\n      position: fixed;\n      z-index: 99999;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background-color: rgba(0,0,0,0.85);\n\n    ",ourPassContentModalDesktop:"\n      position: relative;\n      background-color: rgb(254, 254, 254);\n      margin: auto;\n      width: calc(100% - 50px);\n      height: 80%;\n      display: none;\n      justify-content: center;\n      align-items: center;\n      max-width: 740px;\n      border-radius: 10px;\n    ",ourPassContentModalMobile:"\n      position: relative;\n      background-color: rgb(254, 254, 254);\n      margin: auto;\n      padding: 0;\n      border-radius: 5px;\n      width: 100%;\n      height: 100%;\n      display: none;\n      justify-content: center;\n      align-items: center;\n    ",ourpassIframe:"\n      display: none;\n      border: none;\n      height: 100%;\n      width: 100%;\n      z-index: 99999;\n    ",ourpassCloseButton:"\n      color: white;\n      position: absolute;\n      right: -16px;\n      font-size: 25px;\n      font-weight: bold;\n      cursor: pointer;\n      top: -10px;\n    ",ourpassCloseButtonFocus:"\n      color: #000;\n      text-decoration: none;\n      cursor: pointer;\n    "}),_classPrivateFieldSet(this,_environments,{sandbox:{baseUrl:"https://merchant-sandbox.ourpass.co"},production:{baseUrl:"https://merchant.ourpass.co"}}),_classPrivateFieldSet(this,_config,{})}return _createClass(a,[{key:"handleIframeLoaded",value:function handleIframeLoaded(){this.removeEventListener("load",this.handleIframeLoaded,!0),document.getElementById("ourpassLoaderWrapper").style.display="none",document.getElementById("dFrame").style.display="block",document.getElementById("ourPassContentModal").style.display="block"}},{key:"handleAnimation",value:function handleAnimation(){var a=document.getElementById("ourpassLoaderImg");a||(this.createAnElement("ourpassParentModal","div",["ourpassLoaderWrapper"],_classPrivateFieldGet(this,_dStyle).ourpassLoaderWrapper),this.createAnElement("ourpassLoaderWrapper","img",["ourpassLoaderImg"],_classPrivateFieldGet(this,_dStyle).ourpassLoaderImg),document.getElementById("ourpassLoaderImg").setAttribute("src","https://www.ourpass.co/favicon.ico")),document.getElementById("ourpassLoaderImg").style.display="block",document.getElementById("ourpassLoaderImg").animate([{transform:"scale(0.7)"},{transform:"scale(0.8)"},{transform:"scale(0.7)"}],{duration:1e3,iterations:1/0})}},{key:"generateIframeSrc",value:function generateIframeSrc(){var a=this.clientInfo.items?JSON.stringify(this.clientInfo.items):"",b=this.clientInfo.metadata?JSON.stringify(this.clientInfo.metadata):"",c="".concat(_classPrivateFieldGet(this,_config).baseUrl,"/checkout/?src=").concat(this.clientInfo.src,"&items=").concat(a,"&metadata=").concat(b,"&amount=").concat(this.clientInfo.amount,"&url=").concat(this.clientInfo.url,"&name=").concat(this.clientInfo.name,"&email=").concat(this.clientInfo.email,"&qty=").concat(this.clientInfo.qty,"&description=").concat(this.clientInfo.description,"&api_key=").concat(this.clientInfo.api_key,"&reference=").concat(this.clientInfo.reference);return c}},{key:"g",value:function g(){this.removeElement("ourpassParentModal"),this.clientInfo.onClose()}},{key:"closeOnModal",value:function closeOnModal(){event.target==document.getElementById("ourpassParentModal")&&this.g()}},{key:"createAnElement",value:function createAnElement(a,b,c,d){var e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,f=document.createElement(b);if(f.style.cssText=d,e&&(f.innerHTML=e),f.setAttribute("id",c[0]),1<c.length&&f.setAttribute("".concat(c[1][0]),"".concat(c[1][1])),a instanceof HTMLElement)a.appendChild(f);else if("pass"==a){var g=document.getElementById("button").parentNode;g.appendChild(f)}else document.getElementById(a).appendChild(f);return f}},{key:"removeElement",value:function removeElement(a){a instanceof HTMLElement||(a=document.getElementById(a)),a&&a.parentNode&&a.parentNode.removeChild(a)}},{key:"openIframe",value:function openIframe(a){var b=this,c=document.getElementById("ourpassParentModal");switch(!c||c.remove(),this.clientInfo=a,a.env){case"sandbox":_classPrivateFieldSet(this,_config,_classPrivateFieldGet(this,_environments).sandbox);break;default:_classPrivateFieldSet(this,_config,_classPrivateFieldGet(this,_environments).production);}c=this.createAnElement(document.getElementsByTagName("body")[0],"div",["ourpassParentModal"],_classPrivateFieldGet(this,_dStyle).ourpassParentModal);var d=this.createAnElement("ourpassParentModal","div",["ourPassContentModal"]),e=this.createAnElement("ourPassContentModal","span",["ourpassCloseButton",["onclick","OurpassCheckout.g()"]],_classPrivateFieldGet(this,_dStyle).ourpassCloseButton,"&times;");this.handleAnimation(),_classPrivateFieldGet(this,_isMobileDevice)?(d.style.cssText=_classPrivateFieldGet(this,_dStyle).ourPassContentModalMobile,e.style.display="none"):(_classPrivateFieldGet(this,_dStyle).ourpassIframe="".concat(_classPrivateFieldGet(this,_dStyle).ourpassIframe,"border-radius: 10px;"),d.style.cssText=_classPrivateFieldGet(this,_dStyle).ourPassContentModalDesktop);var f=this.createAnElement("ourPassContentModal","iframe",["dFrame",["src",this.generateIframeSrc()]],_classPrivateFieldGet(this,_dStyle).ourpassIframe);f.addEventListener("load",this.handleIframeLoaded,!0),window.addEventListener("message",function(a){if(_classPrivateFieldGet(b,_config).baseUrl===a.origin&&("false pass"==a.data&&(b.removeElement(c),b.clientInfo.onClose()),"false pass1"==a.data)){var d=b.clientInfo;b.removeElement(c),b.clientInfo.onSuccess(d)}})}}]),a}();window.OurpassCheckout=new Ourpass;